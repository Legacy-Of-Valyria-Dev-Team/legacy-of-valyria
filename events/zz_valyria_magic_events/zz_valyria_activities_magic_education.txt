namespace = zz_valyria_magic_education


# INVALIDATION - PRISON
zz_valyria_magic_education.0005 = {
	type = character_event
	title = zz_valyria_magic_education.0005.t
	desc = zz_valyria_magic_education.0005.desc
	theme = prison

	left_portrait = {
		character = root
		animation = prisonhouse
	}

	immediate = {
		imprisoner ?= {
			save_scope_as = jailor
		}
		create_character_memory = {
			type = imprisoned_adult_education
			participants = {
				jailor = scope:jailor
			}
		}
	}

	option = {
		name = zz_valyria_magic_education.0005.a
	}
}


# CONCLUSION EVENT
zz_valyria_magic_education.0009 = {
	type = activity_event
	title = zz_valyria_magic_education.0009.t
	desc = {
		desc = zz_valyria_magic_education.0009.desc

	}
	theme = university

	center_portrait = {
		character = root
		animation = thinking
	}


	immediate = {
		#Reward effects
		magic_education_completed_log_entry_effect = yes
		
		scope:activity = {
		}
	}
	## Any Study, Increase Skill 
	option = {
		name = zz_valyria_magic_education.0009.a
		trigger = {
			OR = {
				has_character_flag = perfect_reward
				has_character_flag = high_reward
			}
		}
		switch = {
			trigger = has_character_flag
			study_valyrian_secrets = { 
				zz_valyria_gain_spell_experience = {
					XPGAIN = 3 
					XPTRACK = secrets_of_the_higher_mysteries
				}
			}
			study_blood_magic = { 
				zz_valyria_gain_spell_experience = {
					XPGAIN = 3 
					XPTRACK = blood_magic
				}
			}
			study_shadow_magic = {
				zz_valyria_gain_spell_experience = {
					XPGAIN = 3 
					XPTRACK = shadow_magic
				}
			}
			study_dream_magic = {
				zz_valyria_gain_spell_experience = {
					XPGAIN = 3 
					XPTRACK = dream_magic
				}
			}
			study_alchemical_magic = {
				zz_valyria_gain_spell_experience = {
					XPGAIN = 3 
					XPTRACK = alchemical_magic
				}
			}
			study_fire_magic ={
				zz_valyria_gain_spell_experience = {
					XPGAIN = 3 
					XPTRACK = fire_magic
				}
			}
			study_air_magic = {
				zz_valyria_gain_spell_experience = {
					XPGAIN = 3 
					XPTRACK = air_magic
				}
			}
			study_water_magic = {
				zz_valyria_gain_spell_experience = {
					XPGAIN = 3
					XPTRACK = water_magic
				}
			}
		}
	}
	## Valyrian Studies, Random Spell 
	option = {
		name = zz_valyria_magic_education.0009.b 
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag  = study_valyrian_secrets
		}
		zz_random_gain_magic_spell = yes
	}
	## Learn Healing Spell
	option = {
		name = zz_valyria_magic_education.0009.blood.01
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_blood_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = healing_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = healing_spell_flag
		}
	}
	## Learn Genetic Manipulation Spell
	option = {
		name = zz_valyria_magic_education.0009.blood.02
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_blood_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = genetic_manipulation_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = genetic_manipulation_spell_flag
		}
	}
	## Restore MAA
	option = {
		name = zz_valyria_magic_education.0009.blood.03
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_blood_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = men_at_arms_restoration_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = men_at_arms_restoration_spell_flag
		}
	}
	## Restore Army
	option = {
		name = zz_valyria_magic_education.0009.blood.04
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_blood_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = rejuvenate_the_armies_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = rejuvenate_the_armies_spell_flag
		}
	}
	## Shadow Magic 
	option = {
		name = zz_valyria_magic_education.0009.shadow.01
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_shadow_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = shadow_speed_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = shadow_speed_spell_flag
		}
	}
	option = {
		name = zz_valyria_magic_education.0009.shadow.02
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_shadow_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = shadow_dagger_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = shadow_dagger_spell_flag
		}
	}
	option = {
		name = zz_valyria_magic_education.0009.shadow.03
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_shadow_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = shadow_shield_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = shadow_shield_spell_flag
		}
	}
	option = {
		name = zz_valyria_magic_education.0009.shadow.04
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_shadow_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = shadow_cloak_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = shadow_cloak_spell_flag
		}
	}
	## Dream Magic 
	option = {
		name = zz_valyria_magic_education.0009.dream.01
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_dream_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = dreaming_within_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = dreaming_within_spell_flag
		}
	}
	option = {
		name = zz_valyria_magic_education.0009.dream.02
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_dream_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = secrets_of_dreams_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = secrets_of_dreams_spell_flag
		}
	}
	option = {
		name = zz_valyria_magic_education.0009.dream.03
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_dream_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = dreams_of_experience_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = dreams_of_experience_spell_flag
		}
	}
	option = {
		name = zz_valyria_magic_education.0009.dream.04
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_dream_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = mental_domination_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = mental_domination_spell_flag
		}
	}	

	## Alchemy Magic 
	option = {
		name = zz_valyria_magic_education.0009.alchemy.01
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_alchemical_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = empowerment_of_arms_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = empowerment_of_arms_spell_flag
		}
	}	
	option = {
		name = zz_valyria_magic_education.0009.alchemy.02
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_alchemical_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = building_speed_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = building_speed_spell_flag
		}
	}	
	option = {
		name = zz_valyria_magic_education.0009.alchemy.03
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_alchemical_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = development_boost_spell_flag
				}
			}study_valyrian_secrets
		}
		zz_add_spell = { 
			SPELL = development_boost_spell_flag
		}
	}	
	option = {
		name = zz_valyria_magic_education.0009.alchemy.04
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_alchemical_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = transmutation_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = transmutation_spell_flag
		}
	}	
	## Fire Magic
	option = {
		name = zz_valyria_magic_education.0009.fire_magic.01
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_fire_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = flame_strike_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = flame_strike_spell_flag
		}
	}	
	option = {
		name = zz_valyria_magic_education.0009.fire_magic.02
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_fire_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = fire_blast_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = fire_blast_spell_flag
		}
	}	
	option = {
		name = zz_valyria_magic_education.0009.fire_magic.04
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_fire_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = fire_storm_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = fire_storm_spell_flag
		}
	}	
	## Water Magic
	option = {
		name = zz_valyria_magic_education.0009.water_magic.01
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_water_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = crushing_waters_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = crushing_waters_spell_flag
		}
	}	
	option = {
		name = zz_valyria_magic_education.0009.water_magic.02
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_water_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = waters_of_mother_rhoyne_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = waters_of_mother_rhoyne_spell_flag
		}
	}	
	## Air Magic
	option = {
		name = zz_valyria_magic_education.0009.air_magic.01
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_air_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = slicing_winds_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = slicing_winds_spell_flag
		}
	}	
	option = {
		name = zz_valyria_magic_education.0009.air_magic.02
		trigger = {
			has_character_flag = perfect_reward
			has_character_flag = study_air_magic
			NOT = { 
				zz_valyria_knows_spell  = {
					SPELL = tempestuous_winds_spell_flag
				}
			}
		}
		zz_add_spell = { 
			SPELL = tempestuous_winds_spell_flag
		}
	}	

	## No Choice
	option = {
		trigger = {
		}
		name = zz_valyria_magic_education.0009.zz
		ai_chance = {
			base = 100
		}
	}
	after = { 

		remove_character_flag = perfect_reward
		remove_character_flag = high_reward
		remove_character_flag = ok_reward
		remove_character_flag = study_valyrian_secrets
		remove_character_flag = study_blood_magic
		remove_character_flag = study_shadow_magic
		remove_character_flag = study_dream_magic
		remove_character_flag = study_alchemical_magic
		remove_character_flag = study_fire_magic
		remove_character_flag = study_water_magic
		remove_character_flag = study_air_magic
	}
}

## ARRIVAL EVENTS
zz_valyria_magic_education.0010 = {
	type = activity_event
	title = zz_valyria_magic_education.0010.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					location = {
						has_university_building_trigger = yes
					}
				}
				desc = zz_valyria_magic_education.0010.desc_uni
			}
			desc = zz_valyria_magic_education.0010.desc
		}
		desc = zz_valyria_magic_education.0010.desc_end
		triggered_desc = {
			trigger = {
				"scope:host.capital_province.squared_distance(scope:location)" >= squared_distance_massive
			}
			desc = zz_valyria_magic_education.0010.desc_very_very_far
		}
	}
	theme = university

	center_portrait = {
		character = root
		animation = happy_teacher
	}

	immediate = {
		scope:activity.activity_location = { save_scope_as = location }
	}

	option = {
		name = zz_valyria_magic_education.0010.a
	}
}

### ADULT EDUCATION AT DESTINATION EVENTS ###

## You find a a book of technical skill

zz_valyria_magic_education.0100 = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		always = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
						zz_random_gain_magic_spell = yes
						switch = {
							trigger = has_activity_intent
							study_valyrian_secrets = { 
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = secrets_of_the_higher_mysteries
								}
							}
							study_blood_magic = { 
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = blood_magic
								}
							}
							study_shadow_magic = {
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = shadow_magic
								}
							}
							study_dream_magic = {
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = dream_magic
								}
							}
							study_alchemical_magic = {
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = alchemical_magic
								}
							}
							study_fire_magic ={
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = fire_magic
								}
							}
							study_air_magic = {
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = air_magic
								}
							}
							study_water_magic = {
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = water_magic
								}
							}
						}
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}
}

## You have progressed your studies by a moderate amount. 
zz_valyria_magic_education.1100  = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { months = 3 }

	trigger = {
		always = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}
}

## You have progressed your studies by a major amount. 
zz_valyria_magic_education.1200 = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { months = 3 }

	trigger = {
		always = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}
}

### Learn Random Spell/Valyrian Studies 
zz_valyria_magic_education.2100 = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		has_activity_intent = study_valyrian_secrets
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
						zz_random_gain_magic_spell = yes
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}
}

### Learn Blood Magic Spell 
zz_valyria_magic_education.2200 = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		has_activity_intent = study_blood_magic
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
						zz_gain_blood_magic_spell  = yes
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}
	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}
}

### Learn Shadow Magic Spell 
zz_valyria_magic_education.2300 = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		has_activity_intent = study_shadow_magic
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
						zz_gain_shadow_magic_spell = yes
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}	
}

### Learn Dream Magic Spell 
zz_valyria_magic_education.2400 = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		has_activity_intent = study_dream_magic
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
						zz_gain_dream_magic_spell = yes
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}	
}

### Learn Alchemy Spell 
zz_valyria_magic_education.2500 = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		has_activity_intent = study_alchemical_magic
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
						zz_gain_alchemy_spell = yes
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}	
}

### Learn Fire Magic Spell 
zz_valyria_magic_education.2600 = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		has_activity_intent = study_fire_magic
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
						zz_gain_fire_magic_spell = yes
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}	
}

### Learn Water Magic Spell 
zz_valyria_magic_education.2700 = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		has_activity_intent = study_water_magic
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
						zz_gain_water_magic_spell = yes
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}	
}

### Learn Air Magic Spell 
zz_valyria_magic_education.2800 = {
	type = activity_event
	title = zz_valyria_magic_education.0100.t
	desc = zz_valyria_magic_education.0100.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		has_activity_intent = study_air_magic
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.0100.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			30 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.crit_success.tt
					left_icon = root
					hidden_effect = {
						zz_gain_air_magic_spell = yes
					}
					custom_tooltip = zz_valyria_magic_education.1060.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			35 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.0100.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.0100.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.0100.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}
}


## Learn a Spell 
zz_valyria_magic_education.4000 = {
	type = activity_event
	title = zz_valyria_magic_education.4000.t
	desc = zz_valyria_magic_education.4000.desc
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		always = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
			has_trait = theologian
			add = 2
		}
		modifier = {
			has_trait = scholar
			add = 1
		}
	}

	immediate = {
		scope:activity = {
			activity_location = { save_scope_as = location }
		}
		root = { save_scope_as = book_creator }
	}

	# Option A: Study hard intent: think and try to resolve the questions
	option = {
		name = zz_valyria_magic_education.4000.a
		trigger = {
			has_activity_option = {
				category = adult_education_option_books
				option = adult_education_books_good
			}
		}
		duel = {
			skill = learning
			value = high_skill_rating
			15 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.4000.a.crit_success
				send_interface_toast = {
					title = zz_valyria_magic_education.4000.a.crit_success.tt
					left_icon = root
					hidden_effect = {
						zz_random_gain_magic_spell = yes
						switch = {
							trigger = has_activity_intent
							study_valyrian_secrets = { 
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = secrets_of_the_higher_mysteries
								}
							}
							study_blood_magic = { 
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = blood_magic
								}
							}
							study_shadow_magic = {
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = shadow_magic
								}
							}
							study_dream_magic = {
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = dream_magic
								}
							}
							study_alchemical_magic = {
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = alchemical_magic
								}
							}
							study_fire_magic ={
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = fire_magic
								}
							}
							study_air_magic = {
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = air_magic
								}
							}
							study_water_magic = {
								zz_valyria_gain_spell_experience = {
									XPGAIN = 1 
									XPTRACK = water_magic
								}
							}
						}
					}
					custom_tooltip = zz_valyria_magic_education.4000.a.tt
					scope:activity = {
						add_activity_log_entry = {
							key = sic_et_non_log
							score = 25
							tags = { good learning activity }
							character = root
			
							#Effect
							custom_tooltip = adult_education_tt_positive_massive
							scope:activity = { activity_special_type_progression_massive = yes }
						}
					}
				}
				stress_impact = {
					base = medium_stress_impact_loss
				}
			}
			40 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3.5
					min = -49
				}
				desc = zz_valyria_magic_education.4000.a.success
				send_interface_toast = {
					title = zz_valyria_magic_education.4000.a.success.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_major
					scope:activity = { activity_special_type_progression_major = yes }
				}
				stress_impact = {
					base = minor_stress_impact_loss
				}
			}
			45 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3.5
					min = -49
				}
				desc = zz_valyria_magic_education.4000.a.failure
				send_interface_toast = {
					title = zz_valyria_magic_education.4000.a.failure.tt
					left_icon = root
					custom_tooltip = adult_education_tt_positive_tiny
					scope:activity = { activity_special_type_progression_tiny = yes }
				}
				stress_impact = {
					base = medium_stress_impact_gain
				}
			}
		}
		
		ai_chance = {
			base = 100
		}
	}


	# Option C: opt-out
	option = {
		name = zz_valyria_magic_education.4000.c
		stress_impact = {
			base = medium_stress_impact_loss
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}
}