namespace = zz_valyria_colonisation

##establish a foundation
zz_valyria_colonisation.0020 = { # Your men have established a camp -> You are summoned to the Command Tent
	type = activity_event
	title = zz_valyria_colonisation.0020.t
	desc = {
		desc = zz_valyria_colonisation.0020.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_flag = colonization_supply_issues
				}
				desc = zz_valyria_colonisation.0020.supply.desc
			}
			triggered_desc = {
				trigger = {
					has_character_flag = colonization_map_issues
				}
				desc = zz_valyria_colonisation.0020.map.desc
			}
			triggered_desc = {
				trigger = {
					has_character_flag = colonization_settler_soldier_issues
				}
				desc = zz_valyria_colonisation.0020.settler_soldier.desc
			}
			triggered_desc = {
				trigger = {
					has_character_flag = colonization_sickness_issues
				}
				desc = zz_valyria_colonisation.0020.sickness.desc
			}
		}
	}
	theme = university

	center_portrait = {
		character = root
		animation = personality_rational
	}

	cooldown = { years = 1 }

	trigger = {
		always = yes
	}
	immediate = {
		scope:activity.activity_location = { save_scope_as = location }
		add_character_flag = { flag = colonisation_foundation months = 10}
		
		random_list = {
			25 = { # Not enough supplies brought along / Part of supply convoy or wagon lost
				add_character_flag = colonization_supply_issues
			}
			#25 = { # Inaccurate Maps
			#	add_character_flag = colonization_map_issues
			#}
			25 = { # Troops / Settlers want to go home as it finally dawns upon them how dangerous Valyria is
				add_character_flag = colonization_settler_soldier_issues
			}
			25 = { # People get sick during voyage / journey
				add_character_flag = colonization_sickness_issues
			}
		}
	}

	weight_multiplier = {
		base = 1
		modifier = {
			not = { 
				has_character_flag = colonisation_foundation
			}
			add = 100
		}
	}
	
	########################################################## Sickness Issues #################################################
	
	# Option A: Setup a Diesase Management Strategy
	option = {
		name = zz_valyria_colonisation.0020.diesase.a
		trigger = {
			scope:host = {learning > 16}
			has_character_flag = colonization_sickness_issues
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = learning 
			ZZ_EVENT_OPTION_NAME = colonization_sickness_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	# Option B: Hire More Workers
	option = {
		name = zz_valyria_colonisation.0020.diesase.b
		trigger = {
			has_character_flag = colonization_sickness_issues
			scope:host = {stewardship > 16}
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = stewardship 
			ZZ_EVENT_OPTION_NAME = colonization_sickness_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	# Option C: Convince the remaining men to work doubly hard
	option = {
		name = zz_valyria_colonisation.0020.diesase.c
		trigger = {
			has_character_flag = colonization_sickness_issues
			scope:host = {diplomacy > 16}
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = diplomacy 
			ZZ_EVENT_OPTION_NAME = colonization_sickness_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	
	# Option D: Fordibly Quarantine the Sick
	option = {
		name = zz_valyria_colonisation.0020.diesase.d
		trigger = {
			has_character_flag = colonization_sickness_issues
			scope:host = {martial > 16}
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = martial 
			ZZ_EVENT_OPTION_NAME = colonization_sickness_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	
	# Option E: Secretly Euthanize the Sick
	option = {
		name = zz_valyria_colonisation.0020.diesase.e
		trigger = {
			has_character_flag = colonization_sickness_issues
			scope:host = {intrigue > 16}
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = intrigue 
			ZZ_EVENT_OPTION_NAME = colonization_sickness_issues
		}
		
		ai_chance = {
			base = 100
		}
	}

	# Option D: Delegate Command
	option = {
		name = zz_valyria_colonisation.0020.diesase.f
		trigger = {
			has_character_flag = colonization_sickness_issues
		}
		zz_valyria_colonisation_random_test = {
			ZZ_EVENT_OPTION_NAME = colonization_sickness_issues
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}
	
	########################################################## Settler Soldier Issues #################################################
	
	# Option A: Give an inspiring speech
	option = {
		name = zz_valyria_colonisation.0020.settler_soldier_issues.a
		trigger = {
			scope:host = {diplomacy > 16}
			has_character_flag = colonization_settler_soldier_issues
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = diplomacy 
			ZZ_EVENT_OPTION_NAME = colonization_settler_soldier_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	
	# Option B: Hire more workers
	option = {
		name = zz_valyria_colonisation.0020.settler_soldier_issues.b
		trigger = {
			scope:host = {stewardship > 16}
			has_character_flag = colonization_settler_soldier_issues
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = stewardship 
			ZZ_EVENT_OPTION_NAME = colonization_settler_soldier_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	
	# Option C: Hang the worst of the Malcontents
	option = {
		name = zz_valyria_colonisation.0020.settler_soldier_issues.c
		trigger = {
			scope:host = {martial > 16}
			has_character_flag = colonization_settler_soldier_issues
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = martial 
			ZZ_EVENT_OPTION_NAME = colonization_settler_soldier_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	
	# Option D: Hang the worst of the Malcontents
	option = {
		name = zz_valyria_colonisation.0020.settler_soldier_issues.d
		trigger = {
			scope:host = {learning > 16}
			has_character_flag = colonization_settler_soldier_issues
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = learning 
			ZZ_EVENT_OPTION_NAME = colonization_settler_soldier_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	
	# Option D: Delegate Command
	option = {
		name = zz_valyria_colonisation.0020.settler_soldier_issues.f
		trigger = {
			has_character_flag = colonization_settler_soldier_issues
		}
		zz_valyria_colonisation_random_test = {
			ZZ_EVENT_OPTION_NAME = colonization_settler_soldier_issues
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}
	
	########################################################## Supply Issues #################################################
	
	# Option A: Negotiate with Traders to Supply the Colony
	option = {
		name = zz_valyria_colonisation.0020.supply_issues.a
		trigger = {
			scope:host = {diplomacy > 16}
			has_character_flag = colonization_supply_issues
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = diplomacy 
			ZZ_EVENT_OPTION_NAME = colonization_supply_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	
	# Option B: Organise Supply Rationing
	option = {
		name = zz_valyria_colonisation.0020.supply_issues.b
		trigger = {
			scope:host = {stewardship > 16}
			has_character_flag = colonization_supply_issues
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = stewardship 
			ZZ_EVENT_OPTION_NAME = colonization_supply_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	
	# Option C: Organise Scavenging and Hunting Parties
	option = {
		name = zz_valyria_colonisation.0020.supply_issues.c
		trigger = {
			has_character_flag = colonization_supply_issues
			scope:host = {martial > 16}
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = martial 
			ZZ_EVENT_OPTION_NAME = colonization_supply_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	
	# Option D: Secretly replace supplies with substitutes
	option = {
		name = zz_valyria_colonisation.0020.supply_issues.d
		trigger = {
			has_character_flag = colonization_supply_issues
			scope:host = {intrigue > 16}
		}
		zz_valyria_colonisation_skill_test = {
			SKILL = intrigue 
			ZZ_EVENT_OPTION_NAME = colonization_supply_issues
		}
		
		ai_chance = {
			base = 100
		}
	}
	
	# Option E: Delegate Command
	option = {
		name = zz_valyria_colonisation.0020.supply_issues.f
		trigger = {
			has_character_flag = colonization_supply_issues
		}
		zz_valyria_colonisation_random_test = {
			ZZ_EVENT_OPTION_NAME = colonization_supply_issues
		}
		ai_chance = {
			base = 50
			modifier = {
				has_trait = lazy
				add = 100
			}
			modifier = {
				has_trait = intellect_bad
				add = 100
			}
			modifier = {
				has_trait = dull
				add = 100
			}
		}
	}
	
}
