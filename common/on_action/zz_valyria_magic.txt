on_game_start = {
	on_actions = {
		zz_valyria_magic_grant_spells
	}
}




quarterly_playable_pulse = {
	on_actions = {
		zz_valyria_mana_gain_on_action
		zz_valyria_magic_grant_spells
	}
}

zz_valyria_mana_gain_on_action = {
	trigger = {
		has_trait = zz_magister
	}
	effect = {
		zz_valyria_mana_gain = {
			MANAGAIN = 1
		}
		if = {
			limit = {
				has_variable = dragonlore
			}
			change_variable = {
				name = dragonlore
				add = 1
			}
		}
		else = {
			set_variable = {
				name = dragonlore
				value = 1
			}
		}
	}
}

zz_valyria_magic_grant_spells = {
	trigger = {
		has_trait = zz_magister
	}
	effect = {
		#dragon training
		add_character_flag = dragon_training

		#charm magic 

		#shadow magic
		
		#blood magic
		add_character_flag = genetic_manipulation_spell_flag
		add_character_flag = healing_spell_flag
		
		#Alchemical Magic
		add_character_flag = empowerment_of_arms_spell_flag
		add_character_flag = building_speed_spell_flag
		add_character_flag = development_boost_spell_flag
		add_character_flag = transmutation_spell_flag
		
		#Divination Magic
		add_character_flag = dreaming_within_spell_flag
		add_character_flag = secrets_of_dreams_spell_flag
		add_character_flag = dreams_of_experience_spell_flag

		#flame magic 
		add_character_flag = flame_strike_spell_flag
	}
}



on_building_completed = {
	trigger = {
		OR = { 
			has_building_with_flag = { flag = travel_point_of_interest_magic }
			root.capital_barony = {
				this = title:b_valyria_5
			}
		}
		NOT = { has_travel_point_of_interest = travel_point_of_interest_magic }
	}
	effect = { 
		add_travel_point_of_interest = travel_point_of_interest_magic
	}
}

on_travel_plan_cancel = {
	effect = {
		trigger_event = zz_valyria_magic_study_decision.0200
	}
}