set_up_domicile_estate_effect = {
	if = {
		limit = { is_domicile_type = estate }
		# Intentionally one level lower than what you can get
		if = {
			limit = {
				NOT = { has_domicile_building_or_higher = estate_main_02 }
				owner.culture ?= { has_innovation = innovation_city_planning }
			}
			add_domicile_building = estate_main_02
		}
		if = {
			limit = {
				has_domicile_building = estate_main_02
				NOT = { has_domicile_building_or_higher = estate_main_03 }
				owner.culture ?= { has_innovation = innovation_manorialism }
			}
			add_domicile_building = estate_main_03
		}
		switch = {
			trigger = has_domicile_building
			estate_main_03 = {
				while = {
					count = 2
					add_random_internal_estate_building = yes
				}
			}
			estate_main_02 = {
				add_random_internal_estate_building = yes
			}
		}
		fill_external_estate_building_effect = yes
	}
	else_if = {
		limit = { is_domicile_type = dragonkeep }
	}
}