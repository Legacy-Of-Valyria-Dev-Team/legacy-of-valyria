zz_enchant_apply_modifier_effect = {
	if = {
		limit = {
			scope:modifier = trait:$MODIFIER$
		}
		scope:target = {
			while = {
				limit = {
					NOT = {
						root = {
							scope:modifier = trait:zz_valyria_magic_xp_gain_passive_modifier
						}
					}
				}
				count = zz_valyria_magic_alchemy_magic_06_mysteries_of_enchantment_value
				add_artifact_modifier = $MODIFIER$
			}
		}
	}
}



# Alchemical Magic
zz_valyria_magic_alchemy_magic_01_mysteries_of_growth_effect = {  
	send_interface_message = {
		type = event_generic_neutral
		title = zz_valyria_magic_alchemy_magic_01_mysteries_of_growth.t
		desc = zz_valyria_magic_alchemy_magic_01_mysteries_of_growth.desc
		left_icon = scope:actor
		right_icon = scope:target
		custom_tooltip = zz_valyria_magic_alchemy_magic_01_mysteries_of_growth.tt
		scope:target = {
			zz_valyria_magic_apply_province_modifier_effect = { 
				MODIFIER = zz_valyria_magic_alchemy_magic_01_mysteries_of_growth_modifier
				DURATION = 10
				BOOSTED_DURATION = 20
			}
		}
	}
}

zz_valyria_magic_alchemy_magic_02_mysteries_of_construction_effect = {  
	send_interface_message = {
		type = event_generic_neutral
		title = zz_valyria_magic_alchemy_magic_02_mysteries_of_construction.t
		desc = zz_valyria_magic_alchemy_magic_02_mysteries_of_construction.desc
		left_icon = scope:actor
		right_icon = scope:target
		custom_tooltip = zz_valyria_magic_alchemy_magic_02_mysteries_of_construction.tt
		scope:target = {
			zz_valyria_magic_apply_province_modifier_effect = { 
				MODIFIER = zz_valyria_magic_alchemy_magic_02_mysteries_of_construction_modifier
				DURATION = 10
				BOOSTED_DURATION = 20
			}
		}
	}
}

zz_valyria_magic_alchemy_magic_03_mysteries_of_transmutation_effect = {
	send_interface_message = {
		type = event_generic_neutral
		title = zz_valyria_magic_alchemy_magic_03_mysteries_of_transmutation.t
		desc = zz_valyria_magic_alchemy_magic_03_mysteries_of_transmutation.desc
		left_icon = scope:actor
		right_icon = scope:recipient
		custom_tooltip = zz_valyria_magic_alchemy_magic_03_mysteries_of_transmutation.tt
		if = {
			limit = {
				NOT = {
					scope:actor = scope:recipient
				}
			}
			stress_impact = {
				compassionate = medium_stress_impact_loss
				sadistic = minor_stress_gain
				callous = minor_stress_gain
			}
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells003 ?= flag:gold
			}
			scope:recipient = { 
				add_gold = zz_valyria_magic_alchemy_magic_03_mysteries_of_transmutation_option_04 
				domicile ?= { change_provisions = zz_valyria_magic_alchemy_magic_03_mysteries_of_transmutation_option_04 }
			}
		} 
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells003 ?= flag:renown
			}
			scope:recipient = { 
				dynasty = { add_dynasty_prestige = zz_valyria_magic_alchemy_magic_03_mysteries_of_transmutation_option_01}
			}
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells003 ?= flag:prestige
			}
			scope:recipient = { add_prestige = zz_valyria_magic_alchemy_magic_03_mysteries_of_transmutation_option_02 } 
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells003 ?= flag:piety
			}
			scope:recipient = { add_piety = zz_valyria_magic_alchemy_magic_03_mysteries_of_transmutation_option_03 } 
		}
		remove_variable = zz_valyria_magic_alchemy_magic_spells003
						
		scope:recipient = {
			if = {
				limit = {
					NOT = { scope:actor = scope:recipient }
				}
				add_opinion = {
					modifier  = grateful_opinion
					target = scope:actor
					opinion = 70
				}
			}
		}
	}
}

zz_valyria_magic_alchemy_magic_04_mysteries_of_arms_effect = { 
	send_interface_message = {
		type = event_generic_neutral
		title = zz_valyria_magic_alchemy_magic_04_mysteries_of_arms.t
		desc = zz_valyria_magic_alchemy_magic_04_mysteries_of_arms.desc
		left_icon = scope:actor
		right_icon = scope:recipient
		custom_tooltip = zz_valyria_magic_alchemy_magic_04_mysteries_of_arms.tt
		if = {
			limit = {
				NOT = {
					scope:actor = scope:recipient
				}
			}
			stress_impact = {
				compassionate = medium_stress_impact_loss
				sadistic = minor_stress_gain
				callous = minor_stress_gain
			}
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells004 ?= flag:knight_add
			}
			scope:recipient = {
				zz_valyria_magic_apply_character_modifier_effect = { 
					MODIFIER = zz_valyria_magic_alchemy_magic_04_mysteries_of_arms_option_01_modifier
					DURATION = -1
					BOOSTED_DURATION = -1
				}
			}
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells004 ?= flag:knight_bonus
			}
			scope:recipient = {
				zz_valyria_magic_apply_character_modifier_effect = { 
					MODIFIER = zz_valyria_magic_alchemy_magic_04_mysteries_of_arms_option_02_modifer
					DURATION = -1
					BOOSTED_DURATION = -1
				}
			}
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells004 ?= flag:maa_add
			}
			scope:recipient = {
				zz_valyria_magic_apply_character_modifier_effect = { 
					MODIFIER = zz_valyria_magic_alchemy_magic_04_mysteries_of_arms_option_03_modifier
					DURATION = -1
					BOOSTED_DURATION = -1
				}
			}
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells004 ?= flag:maa_size
			}
			scope:recipient = {
				zz_valyria_magic_apply_character_modifier_effect = { 
					MODIFIER = zz_valyria_magic_alchemy_magic_04_mysteries_of_arms_option_04_modifier
					DURATION = -1
					BOOSTED_DURATION = -1
				}
			}
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells004 ?= flag:title_maa_add
			}
			scope:recipient = {
				zz_valyria_magic_apply_character_modifier_effect = { 
					MODIFIER = zz_valyria_magic_alchemy_magic_04_mysteries_of_arms_option_05_modifier
					DURATION = -1
					BOOSTED_DURATION = -1
				}
			}
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells004 ?= flag:title_maa_size
			}
			scope:recipient = {
				zz_valyria_magic_apply_character_modifier_effect = { 
					MODIFIER = zz_valyria_magic_alchemy_magic_04_mysteries_of_arms_option_06_modifier
					DURATION = -1
					BOOSTED_DURATION = -1
				}
			}
		}
		remove_variable = zz_valyria_magic_alchemy_magic_spells004
		scope:recipient = {			
			if = {
				limit = {
					NOT = { scope:actor = scope:recipient }
				}
				add_opinion = {
					modifier = grateful_opinion
					target = scope:actor
					opinion = 70
				}
			}
		}
	}
}


zz_valyria_magic_alchemy_magic_05_mysteries_of_realm_fortification_effect = { 
	send_interface_message = {
		type = event_generic_neutral
		title = zz_valyria_magic_alchemy_magic_05_mysteries_of_realm_fortification.t
		desc = zz_valyria_magic_alchemy_magic_05_mysteries_of_realm_fortification.desc
		left_icon = scope:actor
		right_icon = scope:recipient
		custom_tooltip = zz_valyria_magic_alchemy_magic_05_mysteries_of_realm_fortification.tt
		if = {
			limit = {
				NOT = {
					scope:actor = scope:recipient
				}
			}
			stress_impact = {
				compassionate = medium_stress_impact_loss
				sadistic = minor_stress_gain
				callous = minor_stress_gain
			}
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells005 ?= flag:domain_limit
			}
			scope:recipient = {
				zz_valyria_magic_apply_character_modifier_effect = { 
					MODIFIER = zz_valyria_magic_alchemy_magic_05_mysteries_of_realm_fortification_option_01_modifier
					DURATION = -1
					BOOSTED_DURATION = -1
				}
			}
		}
		if = {
			limit = {
				var:zz_valyria_magic_alchemy_magic_spells005 ?= flag:vassal_limit
			}
			scope:recipient = {
				zz_valyria_magic_apply_character_modifier_effect = { 
					MODIFIER = zz_valyria_magic_alchemy_magic_05_mysteries_of_realm_fortification_option_02_modifier
					DURATION = -1
					BOOSTED_DURATION = -1
				}
			}
		}
		remove_variable = zz_valyria_magic_alchemy_magic_spells005
		scope:recipient = {			
			if = {
				limit = {
					NOT = { scope:actor = scope:recipient }
				}
				add_opinion = {
					modifier = grateful_opinion
					target = scope:actor
					opinion = 70
				}
			}
		}
	}
}


zz_valyria_magic_alchemy_magic_06_mysteries_of_enchantment_effect = {  
	send_interface_message = {
		type = event_generic_neutral
		title = zz_valyria_magic_alchemy_magic_06_mysteries_of_enchantment.t
		desc = zz_valyria_magic_alchemy_magic_06_mysteries_of_enchantment.desc
		left_icon = scope:actor
		right_icon = scope:target
		custom_tooltip = zz_valyria_magic_alchemy_magic_06_mysteries_of_enchantment.tt


		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_magic_mana_gain_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_magic_xp_gain_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_blood_magic_xp_gain_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_shadow_magic_xp_gain_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_dream_magic_xp_gain_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_alchemy_magic_xp_gain_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_fire_magic_xp_gain_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_air_magic_xp_gain_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_water_magic_xp_gain_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_magic_xp_gain_passive_modifier
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_magic_learning_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_magic_diplomacy_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_magic_stewardship_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_magic_martial_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_magic_intrigue_modifier_01_stacking
		}
		zz_enchant_apply_modifier_effect = {
			MODIFIER = zz_valyria_magic_prowess_modifier_01_stacking
		}
	}
}