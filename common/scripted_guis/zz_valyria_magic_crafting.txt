zz_valyria_magic_crafting = {
	scope = character
	saved_scopes = {
	}
	is_shown = {
		exists = var:zz_item_crafter
		is_ai = no
	}
	is_valid = {
	}
	effect = {
	}
}

zz_valyria_magic_crafting_close = {
	scope = character
	saved_scopes = {
	}
	is_shown = {
	}
	is_valid = {
	}
	effect = {
		remove_variable = zz_item_crafter
		clear_variable_list = zz_valyria_item_list
		clear_variable_list = zz_valyria_modifier_list
		clear_variable_list = zz_valyria_province_list
		clear_variable_list = mage_list
	}
}

zz_valyria_magic_item_crafter = {
	scope = character
	saved_scopes = {
		zz_item_crafter
	}
	is_shown = {
		var:zz_item_crafter ?= scope:zz_item_crafter
	}
	effect = {
		scope:zz_item_crafter = {
			root = {
				set_variable = {
					name = zz_item_crafter
					value = scope:zz_item_crafter
				}
			}
		}
	}
}

zz_valyria_magic_item_selection = {
	scope = character
	saved_scopes = {
		zz_selected_item
	}
	is_shown = {
		var:zz_selected_item ?= scope:zz_selected_item
	}
	effect = {
		root = {
			set_variable = {
				name = zz_selected_item
				value = scope:zz_selected_item
			}
			zz_valyria_crafting_calculate_crafting_cost_item_effect = yes 
		}
	}
}

zz_valyria_magic_modifier_selection = {
	scope = character
	saved_scopes = {
		zz_selected_modifier
	}
	is_shown = {
		var:zz_selected_modifier ?= scope:zz_selected_modifier
	}
	effect = {
		root = {
			set_variable = {
				name = zz_selected_modifier
				value = scope:zz_selected_modifier
			}
			zz_valyria_crafting_calculate_crafting_cost_modifier_effect = yes 
		}
	}
}

zz_valyria_magic_item_craft_add_one_iron = {
	scope = character
	is_valid = {
		zz_valyria_resources_iron >= 1
		NOT = {
			zz_valyria_current_use_iron >= zz_valyria_resources_iron
		}
	}
	effect = {
		change_variable = {
			name = zz_current_use_iron
			add = 1
		}
	}
}

zz_valyria_magic_item_craft_minus_one_iron = {
	scope = character
	is_valid = {
		zz_current_use_iron >= 1
	}
	effect = {
		change_variable = {
			name = zz_current_use_iron
			add = -1
		}
	}
}

zz_valyria_magic_item_craft_add_one_steel = {
	scope = character
	is_valid = {
		zz_valyria_resources_steel >= 1
		NOT = {
			zz_valyria_current_use_steel >= zz_valyria_resources_steel
		}
	}
	effect = {
		change_variable = {
			name = zz_current_use_steel
			add = 1
		}
	}
}

zz_valyria_magic_item_craft_minus_one_steel = {
	scope = character
	is_valid = {
		zz_valyria_current_use_steel >= 1
	}
	effect = {
		change_variable = {
			name = zz_current_use_steel
			add = -1
		}
	}
}

zz_valyria_magic_item_craft_add_one_obsidian = {
	scope = character
	is_valid = {
		zz_valyria_resources_obsidian >= 1
		NOT = {
			zz_valyria_current_use_obsidian >= zz_valyria_resources_obsidian
		}
	}
	effect = {
		change_variable = {
			name = zz_current_use_obsidian
			add = 1
		}
	}
}

zz_valyria_magic_item_craft_minus_one_obsidian = {
	scope = character
	is_valid = {
		zz_valyria_current_use_obsidian >= 1
	}
	effect = {
		change_variable = {
			name = zz_current_use_obsidian
			add = -1
		}
	}
}

zz_valyria_magic_item_craft_add_one_valyrian_steel = {
	scope = character
	is_valid = {
		zz_valyria_resources_valyrian_steel >= 1
		NOT = {
			zz_valyria_current_use_valyrian_steel >= zz_valyria_resources_valyrian_steel
		}
	}
	effect = {
		change_variable = {
			name = zz_current_use_valyrian_steel
			add = 1
		}
	}
}

zz_valyria_magic_item_craft_minus_one_valyrian_steel = {
	scope = character
	is_valid = {
		zz_valyria_current_use_valyrian_steel >= 1
	}
	effect = {
		change_variable = {
			name = zz_current_use_valyrian_steel
			add = -1
		}
	}
}

zz_valyria_magic_item_craft = {
	scope = character
	saved_scopes = {
	}
	is_shown = {
	}
	effect = {
		var:zz_item_crafter = {
			save_as_scope = zz_item_crafter
		}
		zz_valyria_crafting_item_construct_effect = yes 
		zz_craft_item_cost_effect = yes
		set_variable = {
			name = zz_current_use_iron
			value = 0
		}
		set_variable = {
			name = zz_current_use_steel
			value = 0
		}
		set_variable = {
			name = zz_current_use_obsidian
			value = 0
		}
		set_variable = {
			name = zz_current_use_valyrian_steel
			value = 0
		}
		set_variable = {
			name = zz_current_cost_item
			value = 0
		}
		set_variable = {
			name = zz_current_cost_modifier
			value = 0
		}
		set_variable = {
			name = zz_current_spend
			value = 0
		}
		set_variable = {
			name = zz_current_magic_reagent
			value = flag:none
		}
	}
}

